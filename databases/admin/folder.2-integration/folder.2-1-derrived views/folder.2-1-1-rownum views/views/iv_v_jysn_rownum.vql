CREATE OR REPLACE VIEW iv_v_jysn_rownum FOLDER = '/2-integration/2-1-derrived views/2-1-1-rownum views' DESCRIPTION = '螳溯｡御ｺ育ｮ暦ｼ�row_number驕ｩ逕ｨ�ｼ�' 
    PRIMARY KEY ( 'kaishacd' , 'kojibg' , 'kojieda' , 'jysnhans' ) AS SELECT bv_v_jysn.kaishacd AS kaishacd, bv_v_jysn.kojibg AS kojibg, bv_v_jysn.kojieda AS kojieda, bv_v_jysn.jysnhans AS jysnhans, bv_v_jysn.jikkysnkakteym AS jikkysnkakteym, bv_v_jysn.kojikakk AS kojikakk, bv_v_jysn.kanstkeihritsu AS kanstkeihritsu, bv_v_jysn.kojignkakei AS kojignkakei, bv_v_jysn.jysnsnseshub AS jysnsnseshub, bv_v_jysn.hassbi AS hassbi, bv_v_jysn.sekoyoteibi AS sekoyoteibi, bv_v_jysn.tuiksekkeihensnsegiyo AS tuiksekkeihensnsegiyo, bv_v_jysn.hasskeinaiy AS hasskeinaiy, bv_v_jysn.kyushmikmizogk AS kyushmikmizogk, bv_v_jysn.kyushmikmigengk AS kyushmikmigengk, bv_v_jysn.sekkeihenmikmigaku AS sekkeihenmikmigaku, bv_v_jysn.sekkeihenyoteibi AS sekkeihenyoteibi, bv_v_jysn.kyushjokycomnt AS kyushjokycomnt, bv_v_jysn.yoinkb AS yoinkb, bv_v_jysn.fusgtjikikb AS fusgtjikikb, bv_v_jysn.taishkkkb AS taishkkkb, bv_v_jysn.fukkryk AS fukkryk, bv_v_jysn.joshikn AS joshikn, bv_v_jysn.saihtsboshi AS saihtsboshi, bv_v_jysn.snsebumnjuyodhanteikb AS snsebumnjuyodhanteikb, bv_v_jysn.claimshorikrkhakktaishflg AS claimshorikrkhakktaishflg, bv_v_jysn.eigybumnbuchkaknflg AS eigybumnbuchkaknflg, bv_v_jysn.eigybumnbuchcomnt AS eigybumnbuchcomnt, bv_v_jysn.gjtsbumnbuchkaknnflg AS gjtsbumnbuchkaknnflg, bv_v_jysn.gijytsbumnbuchcomnt AS gijytsbumnbuchcomnt, bv_v_jysn.kenstsbumnbuchkaknflg AS kenstsbumnbuchkaknflg, bv_v_jysn.kenstsbumnbuchcomnt AS kenstsbumnbuchcomnt, bv_v_jysn.buchchkflg AS buchchkflg, bv_v_jysn.countgaiflg AS countgaiflg, bv_v_jysn.buchjuyodhanteikb AS buchjuyodhanteikb, bv_v_jysn.jishkb AS jishkb, bv_v_jysn.sagyojikn_sekkei AS sagyojikn_sekkei, bv_v_jysn.sagyojikn_koji AS sagyojikn_koji, bv_v_jysn.keiykrban AS keiykrban, bv_v_jysn.kojishub AS kojishub, bv_v_jysn.sakjflg AS sakjflg, bv_v_jysn.jtaikb AS jtaikb, bv_v_jysn.jtaihyojkb AS jtaihyojkb, bv_v_jysn.shnniraibg AS shnniraibg, bv_v_jysn.snseshashaincd AS snseshashaincd, bv_v_jysn.snsebi AS snsebi, bv_v_jysn.shnnshashaincd AS shnnshashaincd, bv_v_jysn.shnnbi AS shnnbi, bv_v_jysn.wfcomnt AS wfcomnt, bv_v_jysn.dwnldjtaikb AS dwnldjtaikb, bv_v_jysn.dwnldshaincd AS dwnldshaincd, bv_v_jysn.dwnldnichj AS dwnldnichj, bv_v_jysn.skseibi AS skseibi, bv_v_jysn.skseishabumncd AS skseishabumncd, bv_v_jysn.skseishashaincd AS skseishashaincd, bv_v_jysn.skseipgid AS skseipgid, bv_v_jysn.kshinbi AS kshinbi, bv_v_jysn.kshinshabumncd AS kshinshabumncd, bv_v_jysn.kshinshashaincd AS kshinshashaincd, bv_v_jysn.kshinpgid AS kshinpgid, bv_v_jysn.rvs AS rvs, row_number() OVER ( PARTITION BY bv_v_jysn.kojibg, bv_v_jysn.kojieda ORDER BY bv_v_jysn.jysnhans DESC ) AS rownum FROM bv_v_jysn WHERE shnnbi is not null ;

ALTER VIEW iv_v_jysn_rownum
 LAYOUT (bv_v_jysn = [20, 20, 200, 200]);

ALTER VIEW iv_v_jysn_rownum
 CACHE FULL
    BATCHSIZEINCACHE DEFAULT TIMETOLIVEINCACHE NOEXPIRE;

